if(KindEditor){KindEditor.lang({pretty:"一键排版"},"zh-CN");function processFormatText(e,d){var h=DBC2SBC(e);var f=h.split("\n");var c="";var g=d.ifblank?' style="text-indent:2em;"':"";for(var b=0;b<f.length;b++){var a=f[b].trim();if(a.length>0){if(a.indexOf("FormatImgID")>0||a.indexOf("FormatTableID")>0||a.indexOf("HEADS_ID")>0||a.indexOf("ULLISTID")>0){c+=a+"\n"}else{c+="<p"+g+">"+a+"</p>\n"}}}return c}function detecteImgSize(a){return function(){a.width=this.width;a.height=this.height}}function FormatText(f,c,e){var p=[],d=[],z=[],o=[],x=[],n=null,s=0;if(f.iftable){var b=c.doc.getElementsByTagName("table");if(b!=null&&b.length>0){var l=0;for(var v=0;v<b.length;){d[d.length]=b[v].outerHTML;b[v].outerHTML="\n#FormatTableID_"+l+"#\n";l++}}}if(f.ifstrong){var g=c.doc.getElementsByTagName("strong");if(g!=null&&g.length>0){var r=0;for(var v=0;v<g.length;){o[o.length]=g[v].outerHTML;g[v].outerHTML="#StrongID_"+r+"#";r++}}}if(f.iflist){s=0;n=c.doc.getElementsByTagName("ul");if(n!=null&&n.length>0){for(var v=0;v<n.length;){z[z.length]=n[v].outerHTML;n[v].outerHTML="\n#ULLISTID_"+s+"#\n";s++}}n=c.doc.getElementsByTagName("ol");if(n!=null&&n.length>0){for(var v=0;v<n.length;){z[z.length]=n[v].outerHTML;n[v].outerHTML="\n#ULLISTID_"+s+"#\n";s++}}}if(f.ifhead){s=0;for(var w=1;w<=6;w++){n=c.doc.getElementsByTagName("h"+w);if(n!=null&&n.length>0){for(var v=0;v<n.length;){x[x.length]=n[v].outerHTML;n[v].outerHTML="#HEADS_ID_"+s+"#";s++}}}}var m=c.doc.images;if(m!=null&&m.length>0){for(w=0;w<m.length;w++){var i=document.createElement("img");i.alt=m[w].alt;i.src=m[w].src;i.width=m[w].width>m[w].clientWidth?m[w].width:m[w].clientWidth;i.height=m[w].height>m[w].clientHeight?m[w].height:m[w].clientHeight;i.align=m[w].align;var u=new Image();u.onload=detecteImgSize(i);u.src=i.src;p.push(i)}var q=0;for(w=0;w<m.length;){m[w].outerHTML="\n#FormatImgID_"+q+"#\n";q++}}var h=processFormatText(e.text(),f);var y="";if(f.ifborder){y='border="1"'}if(p!=null&&p.length>0){for(w=0;w<p.length;w++){var a='<p style="text-align:center;"><img src="'+p[w].src+'" alt="'+p[w].alt+'" '+y+"/></p>";h=h.replace("#FormatImgID_"+w+"#",a)}}if(f.iftable){if(d!=null&&d.length>0){for(v=0;v<d.length;v++){h=h.replace("#FormatTableID_"+v+"#",d[v])}}}if(f.ifstrong){if(o!=null&&o.length>0){for(v=0;v<o.length;v++){h=h.replace("#StrongID_"+v+"#",o[v])}}}if(f.iflist){if(z!=null&&z.length>0){for(v=0;v<z.length;v++){h=h.replace("#ULLISTID_"+v+"#",z[v])}}}if(f.ifhead){if(x!=null&&x.length>0){for(v=0;v<x.length;v++){h=h.replace("#HEADS_ID_"+v+"#",x[v])}}}h=h.replace(/<a[^>]*>(.*?)<\/a>/ig,"\1");return h}function DBC2SBC(c){if(!c){return""}var b="";for(var a=0;a<c.length;a++){code=c.charCodeAt(a);if(code>=65281&&code<65373&&code!=65292&&code!=65306){b+=String.fromCharCode(c.charCodeAt(a)-65248)}else{b+=c.charAt(a)}}return b}String.prototype.trim=function(){return this.replace(/(^[\s　]*)|([\s　]*$)/g,"")};String.prototype.leftTrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.rightTrim=function(){return this.replace(/(\s*$)/g,"")};function formatIt(a,b,c){a.html(b.formatHtml(a.html(),{a:["href","target"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["src","width","height","border","alt","title",".width",".height"],table:["border"],"td,th":["rowspan","colspan"],"div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6,strong":[]},false,false,""));a.html(FormatText(c,a.edit,a))}KindEditor.plugin("pretty",function(a){var b=this,c="pretty";b.clickToolbar("pretty",function(){var d={};d.iftable=a(".keepTable",this.container)[0].checked;d.ifborder=a(".borderImg",this.container)[0].checked;d.ifblank=a(".addBlank",this.container)[0].checked;d.iflist=a(".keepList",this.container)[0].checked;d.ifstrong=a(".keepStrong",this.container)[0].checked;d.ifhead=a(".keepHead",this.container)[0].checked;formatIt(b,a,d);b.focus()})})};